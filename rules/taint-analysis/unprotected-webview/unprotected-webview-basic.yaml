rules:
  - id: unprotected-webview-basic
    mode: taint
    pattern-sources:
      - patterns:
        - pattern-either:
          - pattern: $INTENT.getStringExtra($KEY)
          - pattern: $INTENT.getDataString()
          - pattern: $INTENT.getQueryParameter($KEY)
          - pattern: $BUNDLE.getString($KEY)
          - pattern: $BUNDLE.get($KEY)
        - pattern-not-inside: $ACC onActivityResult(..., Intent $SRC) {...}
        - pattern-not-inside: ActivityResultLauncher<Intent> $LAUNCHER = registerForActivityResult(..., $SRC -> {...});
        - pattern-not-inside: $ACC $METHOD(ActivityResult $SRC) {...}
        - pattern-inside: public class $CLASSNAME extends $COMPONENT {...}
    pattern-sanitizers:
      - patterns:
        - pattern: if ($COND) {...}
        - metavariable-regex:
            metavariable: $COND
            regex: ^.*(((\w+|".+")|Arrays\.asList\(.+\))\.(contains|equals|binarySearch)\(("\w+"|\w+))\)|(\w+\s?(==|!=)\s?("\w+"|[A-Za-z]+)).*$
        - pattern-inside: public class $CLASSNAME extends $COMPONENT {...}
    pattern-sinks:
      - patterns:
        - pattern: $WV.loadUrl($URL, ...);
        - pattern-inside: public class $CLASSNAME extends $COMPONENT {...}
        - focus-metavariable: $URL
    message: $CLASSNAME
    languages:
      - java
    severity: WARNING