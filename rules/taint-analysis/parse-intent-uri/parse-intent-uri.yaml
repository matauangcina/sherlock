rules:
  - id: parse-intent-uri
    mode: taint
    pattern-sources:
      - patterns:
        - pattern-either:
          - pattern: $INTENT.getStringExtra($KEY)
          - pattern: $INTENT.getQueryParameter($KEY)
          - pattern: $INTENT.getDataString()
          - pattern: $BUNDLE.getString($KEY)
          - pattern: $BUNDLE.get($KEY)
        - pattern-inside: public class $CLASSNAME extends $COMPONENT {...}
    pattern-sinks:
      - patterns:
        - pattern: Intent.parseUri($URI, ...)
        - pattern-inside: public class $CLASSNAME extends $COMPONENT {...}
        - focus-metavariable: $URI
    message: $CLASSNAME
    languages:
      - java
    severity: WARNING