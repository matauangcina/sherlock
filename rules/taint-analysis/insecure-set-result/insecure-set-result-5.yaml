rules:
  - id: insecure-set-result-5
    mode: taint
    pattern-sources:
      - patterns:
        - pattern: |
            $RESULT.getData()
        - pattern-inside: |
            public class $CLASSNAME extends $COMPONENT {...}
        - pattern-inside: |
            public void $METHOD(ActivityResult $RESULT) {...}
        - pattern-inside: |
            setResult(...)
    pattern-sinks:
      - patterns:
        - pattern: |
            setResult(..., $INTENT);
        - pattern-inside: |
            public class $CLASSNAME extends $COMPONENT {...}
        - pattern-inside: |
            public void $METHOD(ActivityResult $RESULT) {...}
        - focus-metavariable: $INTENT
    message: $CLASSNAME
    languages:
      - java
    severity: WARNING