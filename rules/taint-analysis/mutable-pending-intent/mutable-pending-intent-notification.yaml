rules:
  - id: mutable-pending-intent-notification
    mode: taint
    pattern-sources:
      - patterns:
        - pattern: PendingIntent.$GET(..., $CODE, $BASE, $FLAG)
        - pattern-inside: public class $CLASSNAME extends $COMPONENT {...}
        - metavariable-regex:
            metavariable: $FLAG
            regex: ^(?!.*AccessibilityEventCompat\.TYPE_VIEW_TARGETED_BY_SCROLL$|PendingIntent\.FLAG_IMMUTABLE$|67108864.*$).*$
    pattern-sinks:
      - patterns:
        - pattern-inside: $NOTIF.setContentIntent(...)
        - pattern-not-inside: $NOTIF.setDeleteIntent(...)
        - pattern-inside: public class $CLASSNAME extends $COMPONENT {...}
    message: $NOTIF
    languages:
      - java
    severity: ERROR