rules:
  - id: insecure-set-result-2
    mode: taint
    pattern-sources:
      - patterns:
        - pattern: |
            getIntent()
        - pattern-inside: |
            public class $CLASSNAME extends $COMPONENT {...}
        - pattern-inside: |
            setResult(...)
    pattern-sinks:
      - patterns:
        - pattern: |
            setResult(..., $INTENT);
        - pattern-inside: |
            public class $CLASSNAME extends $COMPONENT {...}
        - focus-metavariable: $INTENT
    message: $CLASSNAME
    languages:
      - java
    severity: WARNING