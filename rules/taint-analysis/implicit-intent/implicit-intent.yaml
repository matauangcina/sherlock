rules:
  - id: implicit-intent
    mode: taint
    pattern-sources:
      - patterns:
        - pattern-either:
          - pattern: |
              new Intent("$ACTION");
          - pattern: |
              Intent $INTENT = new Intent();
              ...
              $INTENT.setAction("$ACTION");
        - pattern-inside: |
            public class $CLASSNAME extends $COMPONENT {...}
    pattern-sanitizers:
      - patterns:
        - pattern-either:
          - pattern: |
              $INTENT.setClassName(...);
          - pattern: |
              $INTENT.setPackage(...);
          - pattern: |
              $INTENT.setComponentName(...);
        - pattern-inside: |
            public class $CLASSNAME extends $COMPONENT {...}
    pattern-sinks:
      - patterns:
        - pattern-either:
          - pattern: |
              startActivityForResult($INTENT, $CODE);
          - pattern: |
              $LAUNCHER.launch($INTENT);
          - pattern: |
              startActivity($INTENT);
        - pattern-inside: |
            public class $CLASSNAME extends $COMPONENT {...}
        - focus-metavariable: $INTENT
    message: $CLASSNAME
    languages:
      - java
    severity: INFO