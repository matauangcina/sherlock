rules:
  - id: exported-activity-manifest
    patterns:
      - pattern-not: |
          <activity ... android:exported="false" ... />
      - pattern-either:
          - pattern: |
              <activity ... android:name="$ACTIVITY" ... android:exported="true" ... />
          - pattern: |
              <activity ... android:name="$ACTIVITY" ... > ...
              <intent-filter ...>
              ...
              </intent-filter>
              </activity>
      - focus-metavariable: $ACTIVITY
    message: $ACTIVITY
    languages:
      - xml
    severity: INFO