rules:
- id: unsafe-intent-uri-component-basic
  severity: ERROR
  languages:
  - java
  mode: join
  join:
    refs:
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/get-extra/get-uri-string.yaml'
      as: get-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/parse-intent-uri/parse-intent-uri.yaml'
      as: parse-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/unsafe-intent-uri/unsafe-intent-uri-basic.yaml'
      as: intent-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/manifest-analysis/exported-activity.yaml'
      as: exported-activity
    on:
    - get-uri.$KEY == parse-uri.$KEY
    - parse-uri.$URI == intent-uri.$URI
    - exported-activity.$ACTIVITY > intent-uri.$CLASSNAME
  message: |
    Access to arbitrary protected components on an exported activity via unvalidated intent URI scheme detected.
  metadata:
    cwe: cwe-285, cwe-601, cwe-926, cwe-940
    score: 5.7 / Medium
    cvss: CVSS:4.0/AV:L/AC:H/AT:N/PR:N/UI:A/VC:H/VI:L/VA:L/SC:N/SI:N/SA:N
- id: unsafe-intent-uri-component-basic
  severity: ERROR
  languages:
  - java
  mode: join
  join:
    refs:
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/get-extra/get-uri-data.yaml'
      as: get-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/parse-intent-uri/parse-intent-uri.yaml'
      as: parse-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/unsafe-intent-uri/unsafe-intent-uri-basic.yaml'
      as: intent-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/manifest-analysis/exported-activity.yaml'
      as: exported-activity
    on:
    - get-uri.$INTENT == parse-uri.$INTENT
    - parse-uri.$URI == intent-uri.$URI
    - exported-activity.$ACTIVITY > intent-uri.$CLASSNAME
  message: |
    Access to arbitrary protected components on an exported activity via unvalidated intent URI scheme detected.
  metadata:
    cwe: cwe-285, cwe-601, cwe-926, cwe-940
    score: 5.7 / Medium
    cvss: CVSS:4.0/AV:L/AC:H/AT:N/PR:N/UI:A/VC:H/VI:L/VA:L/SC:N/SI:N/SA:N
- id: unsafe-intent-uri-component-implicit
  severity: ERROR
  languages:
  - java
  mode: join
  join:
    refs:
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/get-extra/get-uri-string.yaml'
      as: get-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/parse-intent-uri/parse-intent-uri.yaml'
      as: parse-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/unsafe-intent-uri/unsafe-intent-uri-implicit.yaml'
      as: intent-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/implicit-intent/implicit-start-activity-for-result.yaml'
      as: implicit-intent
    on:
    - get-uri.$KEY == parse-uri.$KEY
    - parse-uri.$URI == intent-uri.$URI
    - implicit-intent.$CLASSNAME == intent-uri.$CLASSNAME
  message: |
    Access to arbitrary protected components on an exported activity via unvalidated intent URI scheme detected.
  metadata:
    cwe: cwe-285, cwe-601, cwe-926, cwe-940
    score: 5.7 / Medium
    cvss: CVSS:4.0/AV:L/AC:H/AT:N/PR:N/UI:A/VC:H/VI:L/VA:L/SC:N/SI:N/SA:N
- id: unsafe-intent-uri-component-implicit
  severity: ERROR
  languages:
  - java
  mode: join
  join:
    refs:
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/get-extra/get-uri-data.yaml'
      as: get-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/parse-intent-uri/parse-intent-uri.yaml'
      as: parse-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/unsafe-intent-uri/unsafe-intent-uri-implicit.yaml'
      as: intent-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/implicit-intent/implicit-start-activity-for-result.yaml'
      as: implicit-intent
    on:
    - get-uri.$INTENT == parse-uri.$INTENT
    - parse-uri.$URI == intent-uri.$URI
    - implicit-intent.$CLASSNAME == intent-uri.$CLASSNAME
  message: |
    Access to arbitrary protected components on an exported activity via unvalidated intent URI scheme detected.
  metadata:
    cwe: cwe-285, cwe-601, cwe-926, cwe-940
    score: 5.7 / Medium
    cvss: CVSS:4.0/AV:L/AC:H/AT:N/PR:N/UI:A/VC:H/VI:L/VA:L/SC:N/SI:N/SA:N
- id: unsafe-intent-uri-webview-basic
  severity: ERROR
  languages:
  - java
  mode: join
  join:
    refs:
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/get-extra/get-uri-string.yaml'
      as: get-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/unprotected-webview/unprotected-webview-basic.yaml'
      as: unprotected-webview
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/unsafe-intent-uri/unsafe-intent-uri-webview.yaml'
      as: intent-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/manifest-analysis/exported-activity.yaml'
      as: exported-activity
    on:
    - get-uri.$KEY == unprotected-webview.$KEY
    - intent-uri.$WV == unprotected-webview.$WV
    - exported-activity.$ACTIVITY > unprotected-webview.$CLASSNAME
  message: |
    Access to arbitrary protected components on an exported activity via unvalidated intent URI scheme loaded on a WebView detected.
  metadata:
    cwe: cwe-285, cwe-601, cwe-926, cwe-940
    score: 5.7 / Medium
    cvss: CVSS:4.0/AV:L/AC:H/AT:N/PR:N/UI:A/VC:H/VI:L/VA:L/SC:N/SI:N/SA:N
- id: unsafe-intent-uri-webview-basic
  severity: ERROR
  languages:
  - java
  mode: join
  join:
    refs:
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/get-extra/get-uri-data.yaml'
      as: get-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/unprotected-webview/unprotected-webview-basic.yaml'
      as: unprotected-webview
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/unsafe-intent-uri/unsafe-intent-uri-webview.yaml'
      as: intent-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/manifest-analysis/exported-activity.yaml'
      as: exported-activity
    on:
    - get-uri.$INTENT == unprotected-webview.$INTENT
    - intent-uri.$WV == unprotected-webview.$WV
    - exported-activity.$ACTIVITY > unprotected-webview.$CLASSNAME
  message: |
    Access to arbitrary protected components on an exported activity via unvalidated intent URI scheme loaded on a WebView detected.
  metadata:
    cwe: cwe-285, cwe-601, cwe-926, cwe-940
    score: 5.7 / Medium
    cvss: CVSS:4.0/AV:L/AC:H/AT:N/PR:N/UI:A/VC:H/VI:L/VA:L/SC:N/SI:N/SA:N
- id: unsafe-intent-uri-webview-implicit
  severity: ERROR
  languages:
  - java
  mode: join
  join:
    refs:
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/get-extra/get-uri-string.yaml'
      as: get-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/unprotected-webview/unprotected-webview-implicit.yaml'
      as: unprotected-webview
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/unsafe-intent-uri/unsafe-intent-uri-webview.yaml'
      as: intent-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/implicit-intent/implicit-start-activity-for-result.yaml'
      as: implicit-intent
    on:
    - get-uri.$KEY == unprotected-webview.$KEY
    - intent-uri.$WV == unprotected-webview.$WV
    - implicit-intent.$CLASSNAME == unprotected-webview.$CLASSNAME
  message: |
    Access to arbitrary protected components via unvalidated intent URI scheme loaded on a WebView and implicit intent interception detected.
  metadata:
    cwe: cwe-285, cwe-601, cwe-926, cwe-940
    score: 5.7 / Medium
    cvss: CVSS:4.0/AV:L/AC:H/AT:N/PR:N/UI:A/VC:H/VI:L/VA:L/SC:N/SI:N/SA:N
- id: unsafe-intent-uri-webview-implicit
  severity: ERROR
  languages:
  - java
  mode: join
  join:
    refs:
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/get-extra/get-uri-data.yaml'
      as: get-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/unprotected-webview/unprotected-webview-implicit.yaml'
      as: unprotected-webview
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/unsafe-intent-uri/unsafe-intent-uri-webview.yaml'
      as: intent-uri
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/implicit-intent/implicit-start-activity-for-result.yaml'
      as: implicit-intent
    on:
    - get-uri.$INTENT == unprotected-webview.$INTENT
    - intent-uri.$WV == unprotected-webview.$WV
    - implicit-intent.$CLASSNAME == unprotected-webview.$CLASSNAME
  message: |
    Access to arbitrary protected components via unvalidated intent URI scheme loaded on a WebView and implicit intent interception detected.
  metadata:
    cwe: cwe-285, cwe-601, cwe-926, cwe-940
    score: 5.7 / Medium
    cvss: CVSS:4.0/AV:L/AC:H/AT:N/PR:N/UI:A/VC:H/VI:L/VA:L/SC:N/SI:N/SA:N
