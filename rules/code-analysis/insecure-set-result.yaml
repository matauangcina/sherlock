rules:
- id: insecure-set-result-basic
  severity: ERROR
  languages:
  - java
  mode: join
  join:
    refs:
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/insecure-set-result/insecure-set-result-basic.yaml'
      as: insecure-set-result
    - rule: '/home/finechina/Tools/sherlock/src/rules/manifest-analysis/exported-activity.yaml'
      as: exported-activity
    on:
    - exported-activity.$ACTIVITY > insecure-set-result.$CLASSNAME
  message: |
    Insecure setResult method on an exported activity detected.
  metadata:
    cwe: cwe-285, cwe-926
    score: 7.1 / High
    cvss: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:A/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
- id: insecure-set-result-implicit
  severity: ERROR
  languages:
  - java
  mode: join
  join:
    refs:
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/insecure-set-result/insecure-set-result-implicit.yaml'
      as: insecure-set-result
    - rule: '/home/finechina/Tools/sherlock/src/rules/taint-analysis/implicit-intent/implicit-start-activity-for-result.yaml'
      as: implicit-intent
    - rule: '/home/finechina/Tools/sherlock/src/rules/manifest-analysis/exported-activity.yaml'
      as: exported-activity
    on:
    - implicit-intent.$CLASSNAME == insecure-set-result.$CLASSNAME
    - exported-activity.$ACTIVITY > insecure-set-result.$CLASSNAME
  message: |
    Insecure setResult method on an exported activity via implicit intent interception detected.
  metadata:
    cwe: cwe-285, cwe-926
    score: 7.1 / High
    cvss: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:A/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
